<!DOCTYPE html>
<html>
  <head>
    <title>Slate Example Configuration</title>
    <link rel='stylesheet' type='text/css' href='css/slate.min.css'>
    <script src='js/slate.min.js'></script>
  </head>

  <body>
    <div class='item-container'>
      <div class='item-container-header'>Complications</div>

      <div class='item-container-content'>
        <label class="item">
          Top-left Left
          <select id="COMPLICATIONS_TL_L" dir='rtl' class="item-select">
            <optgroup>
              <option value="0" class="item-select-option" selected>[none]</option>
            </optgroup>
            <optgroup label="— Time —">
              <option value="1" class="item-select-option">Year</option>
              <option value="1" class="item-select-option">Year</option>
              <option value="2" class="item-select-option">Month</option>
              <option value="3" class="item-select-option">Month name</option>
              <option value="4" class="item-select-option">Week</option>
              <option value="5" class="item-select-option">Year day</option>
              <option value="6" class="item-select-option">Month day</option>
              <option value="7" class="item-select-option">Week day</option>
              <option value="8" class="item-select-option">Day name</option>
              <option value="9" class="item-select-option">Hour</option>
              <option value="10" class="item-select-option">Minute</option>
              <option value="11" class="item-select-option">Second</option>
              <option value="12" class="item-select-option">AM/PM</option>
              <option value="13" class="item-select-option">DST</option>
            </optgroup>
          </select>
        </label>
      </div>

      <div class='item-container-content'>
        <label class="item">
          Top-left Right
          <select id="COMPLICATIONS_TL_R" dir='rtl' class="item-select">
            <optgroup>
              <option value="0" class="item-select-option" selected>[none]</option>
            </optgroup>
            <optgroup label="— Time —">
              <option value="1" class="item-select-option">Year</option>
              <option value="1" class="item-select-option">Year</option>
              <option value="2" class="item-select-option">Month</option>
              <option value="3" class="item-select-option">Month name</option>
              <option value="4" class="item-select-option">Week</option>
              <option value="5" class="item-select-option">Year day</option>
              <option value="6" class="item-select-option">Month day</option>
              <option value="7" class="item-select-option">Week day</option>
              <option value="8" class="item-select-option">Day name</option>
              <option value="9" class="item-select-option">Hour</option>
              <option value="10" class="item-select-option">Minute</option>
              <option value="11" class="item-select-option">Second</option>
              <option value="12" class="item-select-option">AM/PM</option>
              <option value="13" class="item-select-option">DST</option>
            </optgroup>
          </select>
        </label>
      </div>

      <div class='item-container-content'>
        <label class="item">
          Top-right Left
          <select id="COMPLICATIONS_TR_L" dir='rtl' class="item-select">
            <optgroup>
              <option value="0" class="item-select-option" selected>[none]</option>
            </optgroup>
            <optgroup label="— Time —">
              <option value="1" class="item-select-option">Year</option>
              <option value="1" class="item-select-option">Year</option>
              <option value="2" class="item-select-option">Month</option>
              <option value="3" class="item-select-option">Month name</option>
              <option value="4" class="item-select-option">Week</option>
              <option value="5" class="item-select-option">Year day</option>
              <option value="6" class="item-select-option">Month day</option>
              <option value="7" class="item-select-option">Week day</option>
              <option value="8" class="item-select-option">Day name</option>
              <option value="9" class="item-select-option">Hour</option>
              <option value="10" class="item-select-option">Minute</option>
              <option value="11" class="item-select-option">Second</option>
              <option value="12" class="item-select-option">AM/PM</option>
              <option value="13" class="item-select-option">DST</option>
            </optgroup>
          </select>
        </label>
      </div>

      <div class='item-container-content'>
        <label class="item">
          Top-right Right
          <select id="COMPLICATIONS_TR_R" dir='rtl' class="item-select">
            <optgroup>
              <option value="0" class="item-select-option" selected>[none]</option>
            </optgroup>
            <optgroup label="— Time —">
              <option value="1" class="item-select-option">Year</option>
              <option value="1" class="item-select-option">Year</option>
              <option value="2" class="item-select-option">Month</option>
              <option value="3" class="item-select-option">Month name</option>
              <option value="4" class="item-select-option">Week</option>
              <option value="5" class="item-select-option">Year day</option>
              <option value="6" class="item-select-option">Month day</option>
              <option value="7" class="item-select-option">Week day</option>
              <option value="8" class="item-select-option">Day name</option>
              <option value="9" class="item-select-option">Hour</option>
              <option value="10" class="item-select-option">Minute</option>
              <option value="11" class="item-select-option">Second</option>
              <option value="12" class="item-select-option">AM/PM</option>
              <option value="13" class="item-select-option">DST</option>
            </optgroup>
          </select>
        </label>
      </div>

      <div class='item-container-footer'>
        Choose which data to display in each complication.
      </div>
    </div>

    <div class='item-container'>
      <div class='button-container'>
        <input id='submit_button' type='button' class='item-button' value='SUBMIT'>
      </div>
    </div>

    <script>
      function getConfigData() {
        var options = {
          'COMPLICATIONS_TL_L': $("#COMPLICATIONS_TL_L").val() * 1,
          'COMPLICATIONS_TL_R': $("#COMPLICATIONS_TL_R").val() * 1,
          'COMPLICATIONS_TR_L': $("#COMPLICATIONS_TR_L").val() * 1,
          'COMPLICATIONS_TR_R': $("#COMPLICATIONS_TR_R").val() * 1
        };

        // Save for next launch
        localStorage['COMPLICATIONS_TL_L'] = options['COMPLICATIONS_TL_L'];
        localStorage['COMPLICATIONS_TL_R'] = options['COMPLICATIONS_TL_R'];
        localStorage['COMPLICATIONS_TR_L'] = options['COMPLICATIONS_TR_L'];
        localStorage['COMPLICATIONS_TR_R'] = options['COMPLICATIONS_TR_R'];

        console.log('Got options: ' + JSON.stringify(options));
        return options;
      }

      function getQueryParam(variable, defaultValue) {
        var query = location.search.substring(1);
        var vars = query.split('&');
        for (var i = 0; i < vars.length; i++) {
          var pair = vars[i].split('=');
          if (pair[0] === variable) {
            return decodeURIComponent(pair[1]);
          }
        }
        return defaultValue || false;
      }

      (function() {
        $("#submit_button").on('click', function() {
          console.log('Submit');

          // Set the return URL depending on the runtime environment
          var return_to = getQueryParam('return_to', 'pebblejs://close#');
          document.location = return_to + encodeURIComponent(JSON.stringify(getConfigData()));
        });

        // Load any previously saved configuration, if available
        $("#COMPLICATIONS_TL_L").val(localStorage['COMPLICATIONS_TL_L']);
        $("#COMPLICATIONS_TL_R").val(localStorage['COMPLICATIONS_TL_R']);
        $("#COMPLICATIONS_TR_L").val(localStorage['COMPLICATIONS_TR_L']);
        $("#COMPLICATIONS_TR_R").val(localStorage['COMPLICATIONS_TR_R']);
      })();
    </script>
  </body>
</html>
